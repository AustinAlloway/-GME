{% load static %}

<!DOCTYPE html>
<html>

<head>
  <title>{{room.name}} | Listening Party</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- CSS Import List -->
  <link rel="shortcut icon" href="//www.twilio.com/marketing/bundles/marketing/img/favicons/favicon.ico">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.1/css/bulma.min.css" />
  <link rel="stylesheet" href="{% static 'chat/styles/room_detail.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'style.css' %}" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css"
    integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous" />
  <!-- Script Import List -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <!-- MAKE PRETTY SECTION -->
  {% block head %}

  {% endblock %}
  <div class="row justify-content-center" id="signin_navbar_row">
    <div class="d-flex mx-auto" id="navbar_signin_flex">
      {% if 'profile' not in request.session %}
      <div class="col-3 mx-auto" id="signin_col">
        <div class="d-flex-column justify-content-center" id="signin_flexbox">
          <div class="btn-group">
            <a role="button" class="btn btn-outline-light" href="/login/">Log in <i class="fab fa-spotify"></i></a>
            <a role="button" class="btn btn-outline-light" href="https://www.spotify.com/us/signup/"
              target="_blank">Sign Up <i class="fab fa-spotify"></i></a>
          </div>
        </div>
      </div>
      {% else %}
      {{request.session.profile.disply_id}}
      <img src="{{request.session.profile.profile_pic}}" class="rounded-circle" id="profile_thumb" />
      <div class="d-flex" id="pro_log">
        <form action="/logout/" method="POST">
          {% csrf_token %}
          <div class="btn-group">
            <a class="btn btn-outline-light" role="button"
              href="/profile/{{request.session.profile.username}}">Profile</a>
            <button type="button" class="btn btn-outline-light" onclick="form.submit()">Logout</button>
          </div>
        </form>
      </div>
      {% endif %}
      <div class="col-9 mx-auto" id="navbar_col">
        <div class="d-flex justify-content-end " id="navbar_flexbox">
          <div class="btn-group" id="nav_btn_group">
            <a class="btn btn-outline-light" id="navbutton" role="button" href="/">Home</a>
            <a class="btn btn-outline-light disabled" id="navbutton" role="button" href="/">Match Making</a>
            <a class="btn btn-outline-light" id="navbutton" role="button" href="/chat/">Listening Party</a>
            <a class="btn btn-outline-light" id="navbutton" role="button" href="/dev/">Development Page</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</head>

<body>

  <div class="container">

    <div class="row">
      <br>
      <div class="col-8">
        <div style="position: absolute; left: -30px;">
          <div class="row">
            <div class="float-right">
              <h2 class="title">{{room.name}}</h2>
              <p class="subtitle">
                {{room.description}}
              </p>
            </div>
          </div>
          <br>
          <i>Welcome to {{room.name}} </i><br>
          <i>You have joined the {{room.name}} Listening Party.</i><br>
          <i>Feel free to Jam Out and share your thoughts in the Chat. </i>
        </div>
        <div class="d-flex justify-content-center" style="padding-left: 375px; position: absolute; top:-7px"
          id="middle-flex">

          <iframe id="spotify" src="https://open.spotify.com/embed/playlist/3eG8Ulg1ixwU3DPpdgnnGi" width="300"
            height="600" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>

        </div>
      </div>



      <div style="padding-top: 75px;">
        <section style="right: -280px;">
          <div id="messages" style="top: -90px; right:2%; height:450px; width: 538px;"></div>
          <form id="message-form" style="top: 601px; right: 1px; width: 525px;">
            <div class="field">
              <label class="label">Message</label>
              <div class="control">
                <textarea class="textarea" id="message-input" placeholder="Your message here" rows="3"
                  autofocus></textarea>
              </div>
            </div>
            <button type="submit" class="button">Send</button>
          </form>
        </section>
      </div>




    </div>
  </div>


  <!-- Script Import List -->
  <script src="https://media.twiliocdn.com/sdk/js/common/v0.1/twilio-common.min.js"></script>
  <script src="https://media.twiliocdn.com/sdk/js/chat/v2.0/twilio-chat.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
  <script src="{% static 'chat/scripts/rooms.js' %}"></script>
  <script>
    var pathArray = window.location.pathname.split('/')
    var d = new Date();
    var weekday = new Array(7);
    weekday[0] = "sun";
    weekday[1] = "mon";
    weekday[2] = "tues";
    weekday[3] = "wens";
    weekday[4] = "thur";
    weekday[5] = "fri";
    weekday[6] = "sat";

    var n = weekday[d.getDay()];
    if (n != pathArray[2]) {
      // window.location.replace(window.location.protocol + "//" + window.location.host + "/");
      window.alert("Today is " + n + "day" + " you cannot enter this room unless its " + n + "day." + "\n" + "Please go to the right day of the week");
      window.location.replace("http://localhost:8000/chat/");
    };

    if (document.location.pathname == '/rooms/sun/') {

      document.getElementById('spotify').src = 'https://open.spotify.com/embed/playlist/37i9dQZF1DWWQRwui0ExPn';
    };
    if (document.location.pathname == '/rooms/mon/') {

      document.getElementById('spotify').src = 'https://open.spotify.com/embed/playlist/37i9dQZF1DX0BcQWzuB7ZO';
    };
    if (document.location.pathname == '/rooms/tues/') {

      document.getElementById('spotify').src = 'https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M';
    };
    if (document.location.pathname == '/rooms/wens/') {

      document.getElementById('spotify').src = 'https://open.spotify.com/embed/playlist/37i9dQZF1DX4FcAKI5Nhzq';
    };
    if (document.location.pathname == '/rooms/thurs/') {

      document.getElementById('spotify').src = 'https://open.spotify.com/embed/playlist/37i9dQZF1DWVqJMsgEN0F4';
    };
    if (document.location.pathname == '/rooms/fri/') {

      document.getElementById('spotify').src = 'https://open.spotify.com/embed/playlist/37i9dQZF1DXcF6B6QPhFDv';
    };
    if (document.location.pathname == '/rooms/sat/') {

      document.getElementById('spotify').src = 'https://open.spotify.com/embed/playlist/37i9dQZF1DX1lVhptIYRda';
    };
  </script>
</body>

</html>